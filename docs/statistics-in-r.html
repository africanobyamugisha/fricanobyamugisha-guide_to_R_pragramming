<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Statistics in R | A Comprehensive Guide to Use R</title>
<meta name="author" content="Africano BYAMUGISHA">
<meta name="description" content="In addition to R’s powerful data manipulation and graphics facilities, R includes a host of procedures which you can use to analyse your data. Many of these procedures are included with the base...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="7 Statistics in R | A Comprehensive Guide to Use R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.io/africanobyamugisha/statistics-in-r.html">
<meta property="og:image" content="https://github.io/africanobyamugisha/images/flyer.png">
<meta property="og:description" content="In addition to R’s powerful data manipulation and graphics facilities, R includes a host of procedures which you can use to analyse your data. Many of these procedures are included with the base...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Statistics in R | A Comprehensive Guide to Use R">
<meta name="twitter:description" content="In addition to R’s powerful data manipulation and graphics facilities, R includes a host of procedures which you can use to analyse your data. Many of these procedures are included with the base...">
<meta name="twitter:image" content="https://github.io/africanobyamugisha/images/flyer.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Comprehensive Guide to Use R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">*</a></li>
<li><a class="" href="about-the-author.html">About the Author</a></li>
<li><a class="" href="about-this-guide.html">About this guide</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="getting-started-setting-up.html"><span class="header-section-number">2</span> Getting Started &amp; Setting Up</a></li>
<li><a class="" href="operators-data-objects.html"><span class="header-section-number">3</span> Operators &amp; Data Objects</a></li>
<li><a class="" href="working-with-data.html"><span class="header-section-number">4</span> Working With Data</a></li>
<li><a class="" href="data-wrangling.html"><span class="header-section-number">5</span> Data Wrangling</a></li>
<li><a class="" href="data-visualisation.html"><span class="header-section-number">6</span> Data Visualisation</a></li>
<li><a class="active" href="statistics-in-r.html"><span class="header-section-number">7</span> Statistics in R</a></li>
<li><a class="" href="functions.html"><span class="header-section-number">8</span> Functions</a></li>
<li><a class="" href="interactive-reporting-shiny-markdowm-quarto.html"><span class="header-section-number">9</span> Interactive Reporting (Shiny, Markdowm, Quarto)</a></li>
<li><a class="" href="github_r.html"><span class="header-section-number">10</span> Version control with Git and GitHub</a></li>
<li><a class="" href="survey-sampling.html"><span class="header-section-number">11</span> Survey Sampling</a></li>
<li><a class="" href="text-mining-for-qualitative-analysis.html"><span class="header-section-number">12</span> Text Mining for Qualitative Analysis</a></li>
<li><a class="" href="machine-learning.html"><span class="header-section-number">13</span> Machine Learning</a></li>
<li><a class="" href="additional-resources.html">Additional Resources</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="statistics-in-r" class="section level1">
<h1>
<span class="header-section-number">7</span> Statistics in R<a class="anchor" aria-label="anchor" href="#statistics-in-r"><i class="fas fa-link"></i></a>
</h1>
<p>In addition to R’s powerful data manipulation and graphics facilities, R includes a host of procedures which you can use to analyse your data. Many of these procedures are included with the base installation of R, however, even more can be installed with packages available All of the analyses described in this Chapter can be carried out without installing additional packages.</p>
<div id="one-and-two-sample-tests" class="section level2">
<h2>
<span class="header-section-number">7.1</span> One and two sample tests<a class="anchor" aria-label="anchor" href="#one-and-two-sample-tests"><i class="fas fa-link"></i></a>
</h2>
<p>The two main functions for these types of tests are the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> and <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> that perform <em>t</em> tests and Wilcoxon’s signed rank test respectively. Both of these tests can be applied to one and two sample analyses as well as paired data.</p>
<p>As an example of a one sample <em>t</em> test we will use the <code>trees</code> dataset which is included with R. To access this in-built dataset we can use the <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> function. This data set provides measurements of the diameter, height and volume of timber in 31 felled black cherry trees (see <code><a href="https://rdrr.io/r/datasets/trees.html">?trees</a></code> for more detail).</p>
<p></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages('skimr') install.packages('gtExtras')</span></span>
<span><span class="co"># get the inbult data set of trees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="co"># get the general overview of the data using</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    31 obs. of  3 variables:</span></span>
<span><span class="co">##  $ Girth : num  8.3 8.6 8.8 10.5 10.7 10.8 11 11 11.1 11.2 ...</span></span>
<span><span class="co">##  $ Height: num  70 65 63 72 81 83 66 75 80 75 ...</span></span>
<span><span class="co">##  $ Volume: num  10.3 10.3 10.2 16.4 18.8 19.7 15.6 18.2 22.6 19.9 ...</span></span>
<span><span class="co"># Or</span></span>
<span><span class="fu">skimr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:stat1">Table 7.1: </span>Data summary
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
trees
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
31
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table></div>
<p><strong>Variable type: numeric</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Girth
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
13.25
</td>
<td style="text-align:right;">
3.14
</td>
<td style="text-align:right;">
8.3
</td>
<td style="text-align:right;">
11.05
</td>
<td style="text-align:right;">
12.9
</td>
<td style="text-align:right;">
15.25
</td>
<td style="text-align:right;">
20.6
</td>
<td style="text-align:left;">
▃▇▃▅▁
</td>
</tr>
<tr>
<td style="text-align:left;">
Height
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
76.00
</td>
<td style="text-align:right;">
6.37
</td>
<td style="text-align:right;">
63.0
</td>
<td style="text-align:right;">
72.00
</td>
<td style="text-align:right;">
76.0
</td>
<td style="text-align:right;">
80.00
</td>
<td style="text-align:right;">
87.0
</td>
<td style="text-align:left;">
▃▃▆▇▃
</td>
</tr>
<tr>
<td style="text-align:left;">
Volume
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
30.17
</td>
<td style="text-align:right;">
16.44
</td>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
19.40
</td>
<td style="text-align:right;">
24.2
</td>
<td style="text-align:right;">
37.30
</td>
<td style="text-align:right;">
77.0
</td>
<td style="text-align:left;">
▇▅▁▂▁
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a summary of the data using</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="co">##      Girth           Height       Volume     </span></span>
<span><span class="co">##  Min.   : 8.30   Min.   :63   Min.   :10.20  </span></span>
<span><span class="co">##  1st Qu.:11.05   1st Qu.:72   1st Qu.:19.40  </span></span>
<span><span class="co">##  Median :12.90   Median :76   Median :24.20  </span></span>
<span><span class="co">##  Mean   :13.25   Mean   :76   Mean   :30.17  </span></span>
<span><span class="co">##  3rd Qu.:15.25   3rd Qu.:80   3rd Qu.:37.30  </span></span>
<span><span class="co">##  Max.   :20.60   Max.   :87   Max.   :77.00</span></span>
<span><span class="co"># Or</span></span>
<span><span class="fu">gtExtras</span><span class="fu">::</span><span class="fu"><a href="https://jthomasmock.github.io/gtExtras/reference/gt_plt_summary.html">gt_plt_summary</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span></code></pre></div>
<div id="pcnrbwykdt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
html {
  font-family: Lato, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pcnrbwykdt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pcnrbwykdt .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pcnrbwykdt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pcnrbwykdt .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pcnrbwykdt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pcnrbwykdt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 0px;
  border-bottom-color: #D3D3D3;
}

#pcnrbwykdt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pcnrbwykdt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pcnrbwykdt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pcnrbwykdt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pcnrbwykdt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pcnrbwykdt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pcnrbwykdt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pcnrbwykdt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pcnrbwykdt .gt_from_md > :first-child {
  margin-top: 0;
}

#pcnrbwykdt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pcnrbwykdt .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pcnrbwykdt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pcnrbwykdt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pcnrbwykdt .gt_row_group_first td {
  border-top-width: 2px;
}

#pcnrbwykdt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcnrbwykdt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pcnrbwykdt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pcnrbwykdt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcnrbwykdt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcnrbwykdt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pcnrbwykdt .gt_striped {
  background-color: #FAFAFA;
}

#pcnrbwykdt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcnrbwykdt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pcnrbwykdt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcnrbwykdt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pcnrbwykdt .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcnrbwykdt .gt_left {
  text-align: left;
}

#pcnrbwykdt .gt_center {
  text-align: center;
}

#pcnrbwykdt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pcnrbwykdt .gt_font_normal {
  font-weight: normal;
}

#pcnrbwykdt .gt_font_bold {
  font-weight: bold;
}

#pcnrbwykdt .gt_font_italic {
  font-style: italic;
}

#pcnrbwykdt .gt_super {
  font-size: 65%;
}

#pcnrbwykdt .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#pcnrbwykdt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pcnrbwykdt .gt_indent_1 {
  text-indent: 5px;
}

#pcnrbwykdt .gt_indent_2 {
  text-indent: 10px;
}

#pcnrbwykdt .gt_indent_3 {
  text-indent: 15px;
}

#pcnrbwykdt .gt_indent_4 {
  text-indent: 20px;
}

#pcnrbwykdt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<div class="inline-table"><table class="gt_table">
<thead class="gt_header">
<tr>
<td colspan="7" class="gt_heading gt_title gt_font_normal" style>trees</td>
    </tr>
<tr>
<td colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>31 rows x 3 cols</td>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id=""></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Column">Column</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Plot Overview">Plot Overview</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Missing">Missing</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Mean">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Median">Median</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="SD">SD</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="type" class="gt_row gt_left"><svg aria-hidden="true" role="img" viewbox="0 0 576 512" style="height:20px;width:22.5px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#f18e2c;overflow:visible;position:relative;"><path d="M544 0c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V32c0-17.7 14.3-32 32-32zM416 96c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM320 224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32s32 14.3 32 32zM160 288c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V320c0-17.7 14.3-32 32-32zM64 416v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V416c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path></svg></td>
<td headers="name" class="gt_row gt_left" style="font-weight: bold;">Girth</td>
<td headers="value" class="gt_row gt_center">
<?xml version='1.0' encoding='UTF-8' ?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02"><defs><style type="text/css"><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="><rect x="0.00" y="0.00" width="141.73" height="34.02"></rect></clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs><clippath id="cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw=="><rect x="1.00" y="1.00" width="139.74" height="22.64"></rect></clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw==)"><rect x="7.35" y="17.98" width="21.17" height="5.66" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="28.52" y="1.00" width="21.17" height="22.64" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="49.69" y="8.54" width="21.17" height="15.09" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="70.87" y="17.98" width="21.17" height="5.66" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="92.04" y="16.09" width="21.17" height="7.55" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="113.21" y="21.75" width="21.17" height="1.89" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="19.16" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="118.50" cy="21.75" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><line x1="56.56" y1="23.63" x2="56.56" y2="1.00" style="stroke-width: 1.07; stroke-linecap: butt;"></line></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><polyline points="1.00,23.63 140.74,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="20.14,26.47 20.14,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="117.53,26.47 117.53,23.63 " style="stroke-width: 0.75;"></polyline><text x="20.14" y="33.29" text-anchor="middle" style='font-size: 6.00px; font-family: "Arial";' textlength="3.60px" lengthadjust="spacingAndGlyphs">8</text><text x="117.53" y="33.29" text-anchor="middle" style='font-size: 6.00px; font-family: "Arial";' textlength="7.20px" lengthadjust="spacingAndGlyphs">21</text></g></svg>
</td>
<td headers="n_missing" class="gt_row gt_right">0.0%</td>
<td headers="Mean" class="gt_row gt_right">13.2</td>
<td headers="Median" class="gt_row gt_right">12.9</td>
<td headers="SD" class="gt_row gt_right">3.1</td>
</tr>
<tr>
<td headers="type" class="gt_row gt_left gt_striped"><svg aria-hidden="true" role="img" viewbox="0 0 576 512" style="height:20px;width:22.5px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#f18e2c;overflow:visible;position:relative;"><path d="M544 0c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V32c0-17.7 14.3-32 32-32zM416 96c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM320 224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32s32 14.3 32 32zM160 288c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V320c0-17.7 14.3-32 32-32zM64 416v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V416c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path></svg></td>
<td headers="name" class="gt_row gt_left gt_striped" style="font-weight: bold;">Height</td>
<td headers="value" class="gt_row gt_center gt_striped">
<?xml version='1.0' encoding='UTF-8' ?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02"><defs><style type="text/css"><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="><rect x="0.00" y="0.00" width="141.73" height="34.02"></rect></clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs><clippath id="cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw=="><rect x="1.00" y="1.00" width="139.74" height="22.64"></rect></clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw==)"><rect x="7.35" y="21.37" width="21.17" height="2.26" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="28.52" y="16.84" width="21.17" height="6.79" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="49.69" y="12.32" width="21.17" height="11.32" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="70.87" y="3.26" width="21.17" height="20.37" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="92.04" y="1.00" width="21.17" height="22.64" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="113.21" y="16.84" width="21.17" height="6.79" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="24.75" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="126.52" cy="21.37" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><line x1="79.79" y1="23.63" x2="79.79" y2="1.00" style="stroke-width: 1.07; stroke-linecap: butt;"></line></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><polyline points="1.00,23.63 140.74,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="25.75,26.47 25.75,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="125.52,26.47 125.52,23.63 " style="stroke-width: 0.75;"></polyline><text x="25.75" y="33.29" text-anchor="middle" style='font-size: 6.00px; font-family: "Arial";' textlength="7.20px" lengthadjust="spacingAndGlyphs">63</text><text x="125.52" y="33.29" text-anchor="middle" style='font-size: 6.00px; font-family: "Arial";' textlength="7.20px" lengthadjust="spacingAndGlyphs">87</text></g></svg>
</td>
<td headers="n_missing" class="gt_row gt_right gt_striped">0.0%</td>
<td headers="Mean" class="gt_row gt_right gt_striped">76.0</td>
<td headers="Median" class="gt_row gt_right gt_striped">76.0</td>
<td headers="SD" class="gt_row gt_right gt_striped">6.4</td>
</tr>
<tr>
<td headers="type" class="gt_row gt_left"><svg aria-hidden="true" role="img" viewbox="0 0 576 512" style="height:20px;width:22.5px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#f18e2c;overflow:visible;position:relative;"><path d="M544 0c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V32c0-17.7 14.3-32 32-32zM416 96c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM320 224V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V224c0-17.7 14.3-32 32-32s32 14.3 32 32zM160 288c17.7 0 32 14.3 32 32V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V320c0-17.7 14.3-32 32-32zM64 416v64c0 17.7-14.3 32-32 32s-32-14.3-32-32V416c0-17.7 14.3-32 32-32s32 14.3 32 32z"></path></svg></td>
<td headers="name" class="gt_row gt_left" style="font-weight: bold;">Volume</td>
<td headers="value" class="gt_row gt_center">
<?xml version='1.0' encoding='UTF-8' ?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svglite" width="141.73pt" height="34.02pt" viewbox="0 0 141.73 34.02"><defs><style type="text/css"><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width="100%" height="100%" style="stroke: none; fill: none;"></rect><defs><clippath id="cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg=="><rect x="0.00" y="0.00" width="141.73" height="34.02"></rect></clippath></defs><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"></g><defs><clippath id="cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw=="><rect x="1.00" y="1.00" width="139.74" height="22.64"></rect></clippath></defs><g clip-path="url(#cpMS4wMHwxNDAuNzR8MS4wMHwyMy42Mw==)"><rect x="7.35" y="15.55" width="18.15" height="8.09" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="25.50" y="1.00" width="18.15" height="22.64" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="43.64" y="15.55" width="18.15" height="8.09" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="61.79" y="20.40" width="18.15" height="3.23" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="79.94" y="17.17" width="18.15" height="6.47" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="98.09" y="23.63" width="18.15" height="0.00" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><rect x="116.24" y="22.02" width="18.15" height="1.62" style="stroke-width: 1.07; stroke: #FFFFFF; stroke-linecap: butt; stroke-linejoin: miter; fill: #F8BB87;"></rect><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="13.45" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><circle cx="121.96" cy="22.02" r="0.46" style="stroke-width: 0.71; stroke: none;"></circle><line x1="36.81" y1="23.63" x2="36.81" y2="1.00" style="stroke-width: 1.07; stroke-linecap: butt;"></line></g><g clip-path="url(#cpMC4wMHwxNDEuNzN8MC4wMHwzNC4wMg==)"><polyline points="1.00,23.63 140.74,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="14.52,26.47 14.52,23.63 " style="stroke-width: 0.75;"></polyline><polyline points="120.89,26.47 120.89,23.63 " style="stroke-width: 0.75;"></polyline><text x="14.52" y="33.29" text-anchor="middle" style='font-size: 6.00px; font-family: "Arial";' textlength="7.20px" lengthadjust="spacingAndGlyphs">10</text><text x="120.89" y="33.29" text-anchor="middle" style='font-size: 6.00px; font-family: "Arial";' textlength="7.20px" lengthadjust="spacingAndGlyphs">77</text></g></svg>
</td>
<td headers="n_missing" class="gt_row gt_right">0.0%</td>
<td headers="Mean" class="gt_row gt_right">30.2</td>
<td headers="Median" class="gt_row gt_right">24.2</td>
<td headers="SD" class="gt_row gt_right">16.4</td>
</tr>
</tbody>
</table></div>
</div>

<p>If we wanted to test whether the mean height of black cherry trees in this sample is equal to 70 ft (<code>mu = 70</code>), assuming these data are normally distributed, we can use a <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> to do so.</p>

<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, mu <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  trees$Height</span></span>
<span><span class="co">## t = 5.2429, df = 30, p-value = 1.173e-05</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 70</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  73.6628 78.3372</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">##        76</span></span></code></pre></div>

<p>The above summary has a fairly logical layout and includes the name of the test that we have asked for (<code>One Sample t-test</code>), which data has been used (<code>data:  trees$Height</code>), the <em>t</em> statistic, degrees of freedom and associated <em>p</em> value (<code>t = 5.2, df = 30, p-value = 1e-05</code>). It also states the alternative hypothesis (<code>alternative hypothesis: true mean is not equal to 70</code>) which tells us this is a two sided test (as we have both equal and not equal to), the 95% confidence interval for the mean (<code>95 percent confidence interval:73.66 78.34</code>) and also an estimate of the mean (<code>sample estimates: mean of x : 76</code>). In the above example, the <em>p</em> value is very small and therefore we would reject the null hypothesis and conclude that the mean height of our sample of black cherry trees is not equal to 70 ft.</p>
<p>The function <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> also has a number of additional arguments which can be used for one-sample tests. You can specify that a one sided test is required by using either <code>alternative = "greater"</code> or <code>alternative = "less</code> arguments which tests whether the sample mean is greater or less than the mean specified. For example, to test whether our sample mean is greater than 70 ft.</p>

<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, mu <span class="op">=</span> <span class="fl">70</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  trees$Height</span></span>
<span><span class="co">## t = 5.2429, df = 30, p-value = 5.866e-06</span></span>
<span><span class="co">## alternative hypothesis: true mean is greater than 70</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  74.05764      Inf</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">##        76</span></span></code></pre></div>

<p>You can also change the confidence level used for estimating the confidence intervals using the argument <code>conf.level = 0.99</code>. If specified in this way, 99% confidence intervals would be estimated.</p>
<p>Although <em>t</em> tests are fairly robust against small departures from normality you may wish to use a rank based method such as the Wilcoxon’s signed rank test. In R, this is done in almost exactly the same way as the <em>t</em> test but using the <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> function.</p>

<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, mu <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon signed rank test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  trees$Height</span></span>
<span><span class="co">## V = 419.5, p-value = 0.0001229</span></span>
<span><span class="co">## alternative hypothesis: true location is not equal to 70</span></span></code></pre></div>

<p>Don’t worry too much about the warning message, R is just letting you know that your sample contained a number of values which were the same and therefore it was not possible to calculate an exact <em>p</em> value. This is only really a problem with small sample sizes. You can also use the arguments <code>alternative = "greater"</code> and <code>alternative = "less"</code>.</p>
<p>In our one sample test it’s always a good idea to examine your data for departures from normality, rather than just assuming everything is OK. Perhaps the simplest way to assess normality is the ‘quantile-quantile plot’. This graph plots the ranked sample quantiles from your distribution against a similar number of ranked quantiles taken from a normal distribution. If your data are normally distributed then the plot of your data points will be in a straight line. Departures from normality will show up as a curve or s-shape in your data points. Judging just how much departure is acceptable comes with a little bit of practice.</p>
<p>To construct a Q-Q plot you need to use both the <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm()</a></code>and <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqline()</a></code>functions. The <code>lty = 2</code> argument changes the line to a dashed line.</p>

<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/stat5-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>If you insist on performing a specific test for normality you can use the function <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> which performs a Shapiro – Wilks test of normality.</p>

<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Shapiro-Wilk normality test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  trees$Height</span></span>
<span><span class="co">## W = 0.96545, p-value = 0.4034</span></span></code></pre></div>

<p>In the example above, the <em>p</em> value = 0.4 which suggests that there is no evidence to reject the null hypothesis and we can therefore assume these data are normally distributed.</p>
<p>In addition to one-sample tests, both the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> and <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> functions can be used to test for differences between two samples. A two sample <em>t</em> test is used to test the null hypothesis that the two samples come from distributions with the same mean (i.e. the means are not different). For example, a study was conducted to test whether ‘seeding’ clouds with dimethylsulphate alters the moisture content of clouds. Ten random clouds were ‘seeded’ with a further ten ‘unseeded’. The dataset can be found in the <code>atmosphere.txt</code> data file located in the link for the data sets for this guide. <a href="https://github.com/africanobyamugisha/datasets/tree/main/guide_to_R_programming%20data" title="click here to open the data folder">click here to open the data folder</a></p>

<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atmos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/atmosphere.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">atmos</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    20 obs. of  2 variables:</span></span>
<span><span class="co">##  $ moisture : num  301 302 299 316 307 ...</span></span>
<span><span class="co">##  $ treatment: chr  "seeded" "seeded" "seeded" "seeded" ...</span></span></code></pre></div>

<p>As with our previous data frame (<code>flowers</code>), these data are in the long format. The column <code>moisture</code> contains the moisture content measured in each cloud and the column <code>treatment</code> identifies whether the cloud was <code>seeded</code> or <code>unseeded</code>. To perform a two-sample <em>t</em> test</p>

<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">atmos</span><span class="op">$</span><span class="va">moisture</span> <span class="op">~</span> <span class="va">atmos</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  atmos$moisture by atmos$treatment</span></span>
<span><span class="co">## t = 2.5404, df = 16.807, p-value = 0.02125</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group seeded and group unseeded is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##   1.446433 15.693567</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##   mean in group seeded mean in group unseeded </span></span>
<span><span class="co">##                 303.63                 295.06</span></span></code></pre></div>

<p>Notice the use of the formula method (<code>atmos$moisture ~ atmos$treatment</code>, which can be read as ‘the moisture described by treatment’) to specify the test. You can also use other methods depending on the format of the data frame. Use <code><a href="https://rdrr.io/r/stats/t.test.html">?t.test</a></code> for further details. The details of the output are similar to the one-sample <em>t</em> test. The Welch’s variant of the <em>t</em> test is used by default and does not assume that the variances of the two samples are equal. If you are sure the variances in the two samples are the same, you can specify this using the <code>var.equal = TRUE</code> argument</p>

<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">atmos</span><span class="op">$</span><span class="va">moisture</span> <span class="op">~</span> <span class="va">atmos</span><span class="op">$</span><span class="va">treatment</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  atmos$moisture by atmos$treatment</span></span>
<span><span class="co">## t = 2.5404, df = 18, p-value = 0.02051</span></span>
<span><span class="co">## alternative hypothesis: true difference in means between group seeded and group unseeded is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##   1.482679 15.657321</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##   mean in group seeded mean in group unseeded </span></span>
<span><span class="co">##                 303.63                 295.06</span></span></code></pre></div>

<p>To test whether the assumption of equal variances is valid you can perform an <em>F</em>-test on the ratio of the group variances using the <code><a href="https://rdrr.io/r/stats/var.test.html">var.test()</a></code> function.</p>

<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">atmos</span><span class="op">$</span><span class="va">moisture</span> <span class="op">~</span> <span class="va">atmos</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  F test to compare two variances</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  atmos$moisture by atmos$treatment</span></span>
<span><span class="co">## F = 0.57919, num df = 9, denom df = 9, p-value =</span></span>
<span><span class="co">## 0.4283</span></span>
<span><span class="co">## alternative hypothesis: true ratio of variances is not equal to 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.1438623 2.3318107</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## ratio of variances </span></span>
<span><span class="co">##          0.5791888</span></span></code></pre></div>

<p>As the <em>p</em> value is greater than 0.05, there is no evidence to suggest that the variances are unequal. Note however, that the <em>F</em>-test is sensitive to departures from normality and should not be used with data which is not normal. See the <code>car</code> package for alternatives.</p>
<p>The non-parametric two-sample Wilcoxon test (also known as a Mann-Whitney U test) can be performed using the same formula method:</p>

<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">atmos</span><span class="op">$</span><span class="va">moisture</span> <span class="op">~</span> <span class="va">atmos</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon rank sum exact test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  atmos$moisture by atmos$treatment</span></span>
<span><span class="co">## W = 79, p-value = 0.02881</span></span>
<span><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>

<p>You can also use the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> and <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> functions to test paired data. Paired data are where there are two measurements on the same experimental unit (individual, site etc) and essentially tests for whether the mean difference between the paired observations is equal to zero. For example, the <code>pollution</code> dataset gives the biodiversity score of aquatic invertebrates collected using kick samples in 17 different rivers. These data are paired because two samples were taken on each river, one upstream of a paper mill and one downstream.</p>

<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pollution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/pollution.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pollution</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    16 obs. of  2 variables:</span></span>
<span><span class="co">##  $ down: int  20 15 10 5 20 15 10 5 20 15 ...</span></span>
<span><span class="co">##  $ up  : int  23 16 10 4 22 15 12 7 21 16 ...</span></span></code></pre></div>

<p>Note, in this case these data are in the wide format with upstream and downstream values in separate columns (see previous topics on how to convert to long format if you want). To conduct a paired <em>t</em> test use the <code>paired = TRUE</code> argument.</p>

<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">pollution</span><span class="op">$</span><span class="va">down</span>, <span class="va">pollution</span><span class="op">$</span><span class="va">up</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Paired t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  pollution$down and pollution$up</span></span>
<span><span class="co">## t = -3.0502, df = 15, p-value = 0.0081</span></span>
<span><span class="co">## alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -1.4864388 -0.2635612</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean difference </span></span>
<span><span class="co">##          -0.875</span></span></code></pre></div>

<p>The output is almost identical to that of a one-sample <em>t</em> test. It is also possible to perform a non-parametric matched-pairs Wilcoxon test in the same way</p>

<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">pollution</span><span class="op">$</span><span class="va">down</span>, <span class="va">pollution</span><span class="op">$</span><span class="va">up</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon signed rank test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  pollution$down and pollution$up</span></span>
<span><span class="co">## V = 8, p-value = 0.01406</span></span>
<span><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>

<p>The function <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> can be used to compare two or more proportions. For example, a company wishes to test the effectiveness of an advertising campaign for a particular brand of cat food. The company commissions two polls, one before the advertising campaign and one after, with each poll asking cat owners whether they would buy this brand of cat food. The results are given in the table below</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center"></th>
<th align="center">before</th>
<th align="center">after</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">would buy</td>
<td align="center">45</td>
<td align="center">71</td>
</tr>
<tr class="even">
<td align="center">would not buy</td>
<td align="center">35</td>
<td align="center">32</td>
</tr>
</tbody>
</table></div>
<p>From the table above we can conclude that 56% of cat owners would buy the cat food before the campaign compared to 69% after. But, has the advertising campaign been a success?</p>
<p>The <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> function has two main arguments which are given as two vectors. The first vector contains the number of positive outcomes and the second vector the total numbers for each group. So to perform the test we first need to define these vectors</p>

<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">buy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">71</span><span class="op">)</span>  <span class="co"># creates a vector of positive outcomes</span></span>
<span><span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">45</span> <span class="op">+</span> <span class="fl">35</span><span class="op">)</span>, <span class="op">(</span><span class="fl">71</span> <span class="op">+</span> <span class="fl">32</span><span class="op">)</span><span class="op">)</span>  <span class="co"># creates a vector of total numbers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">buy</span>, <span class="va">total</span><span class="op">)</span>  <span class="co"># perform the test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  2-sample test for equality of proportions with</span></span>
<span><span class="co">##  continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  buy out of total</span></span>
<span><span class="co">## X-squared = 2.598, df = 1, p-value = 0.107</span></span>
<span><span class="co">## alternative hypothesis: two.sided</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.27865200  0.02501122</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##    prop 1    prop 2 </span></span>
<span><span class="co">## 0.5625000 0.6893204</span></span></code></pre></div>

<p>There is no evidence to support that the advertising campaign has changed cat owners opinions of the cat food (<em>p</em> = 0.1). Use <code><a href="https://rdrr.io/r/stats/prop.test.html">?prop.test</a></code> to explore additional uses of the binomial proportions test.</p>
<p>We could also analyse the count data in the above example as a Chi-square contingency table. The simplest method is to convert the tabulated table into a 2 x 2 matrix using the <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> function (note, there are many alternative methods of constructing a table like this).</p>

<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">buyers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">35</span>, <span class="fl">71</span>, <span class="fl">32</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">buyers</span></span>
<span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]   45   71</span></span>
<span><span class="co">## [2,]   35   32</span></span></code></pre></div>

<p>Notice that you enter the data column wise into the matrix and then specify the number of rows using <code>nrow =</code>.</p>
<p>We can also change the row names and column names from the defaults to make it look more like a table (you don’t really need to do this to perform a Chi-square test)</p>

<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">buyers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"before"</span>, <span class="st">"after"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">buyers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"buy"</span>, <span class="st">"notbuy"</span><span class="op">)</span></span>
<span><span class="va">buyers</span></span>
<span><span class="co">##        before after</span></span>
<span><span class="co">## buy        45    71</span></span>
<span><span class="co">## notbuy     35    32</span></span></code></pre></div>

<p>You can then perform a Chi-square test to test whether the number of cat owners buying the cat food is independent of the advertising campaign using the <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function. In this example the only argument is our matrix of counts.</p>

<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">buyers</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test with Yates' continuity</span></span>
<span><span class="co">##  correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  buyers</span></span>
<span><span class="co">## X-squared = 2.598, df = 1, p-value = 0.107</span></span></code></pre></div>

<p>There is no evidence (<em>p</em> = 0.107) to suggest that we should reject the null hypothesis that the number of cat owners buying the cat food is independent of the advertising campaign. You may have spotted that for a 2x2 table, this test is exactly equivalent to the <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code>. You can also use the <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function on raw (untabulated) data and to test for goodness of fit (see <code><a href="https://rdrr.io/r/stats/chisq.test.html">?chisq.test</a></code> for more details).</p>
</div>
<div id="correlation" class="section level2">
<h2>
<span class="header-section-number">7.2</span> Correlation<a class="anchor" aria-label="anchor" href="#correlation"><i class="fas fa-link"></i></a>
</h2>
<p>In R, the Pearson’s product-moment correlation coefficient between two continuous variables can be estimated using the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function. Using the <code>trees</code> data set again, we can determine the correlation coefficient of the association between tree <code>Height</code> and <code>Volume</code>.</p>

<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    31 obs. of  3 variables:</span></span>
<span><span class="co">##  $ Girth : num  8.3 8.6 8.8 10.5 10.7 10.8 11 11 11.1 11.2 ...</span></span>
<span><span class="co">##  $ Height: num  70 65 63 72 81 83 66 75 80 75 ...</span></span>
<span><span class="co">##  $ Volume: num  10.3 10.3 10.2 16.4 18.8 19.7 15.6 18.2 22.6 19.9 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, <span class="va">trees</span><span class="op">$</span><span class="va">Volume</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.5982497</span></span></code></pre></div>

<p>or we can produce a matrix of correlation coefficients for all variables in a data frame</p>

<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="co">##            Girth    Height    Volume</span></span>
<span><span class="co">## Girth  1.0000000 0.5192801 0.9671194</span></span>
<span><span class="co">## Height 0.5192801 1.0000000 0.5982497</span></span>
<span><span class="co">## Volume 0.9671194 0.5982497 1.0000000</span></span></code></pre></div>

<p>Note that the correlation coefficients are identical in each half of the matrix. Also, be aware that, although a matrix of coefficients can be useful, a little commonsense should be used when using <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> on data frames with numerous variables. It is not good practice to trawl through these types of matrices in the hope of finding large coefficients without having an <em>a priori</em> reason for doing so and remember the correlation coefficient assumes that associations are linear.</p>
<p>If you have missing values in the variables you are trying to correlate, <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> will return an error message (as will many functions in R). You will either have to remove these observations (be very careful if you do this) or tell R what to do when an observation is missing. A useful argument you can use with the <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> function is <code>use = "complete.obs"</code>.</p>

<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">trees</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span>
<span><span class="co">##            Girth    Height    Volume</span></span>
<span><span class="co">## Girth  1.0000000 0.5192801 0.9671194</span></span>
<span><span class="co">## Height 0.5192801 1.0000000 0.5982497</span></span>
<span><span class="co">## Volume 0.9671194 0.5982497 1.0000000</span></span></code></pre></div>

<p>The function <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code> will return the correlation coefficient of two variables, but gives no indication whether the coefficient is significantly different from zero. To do this you need to use the function <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code>.</p>

<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, <span class="va">trees</span><span class="op">$</span><span class="va">Volume</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's product-moment correlation</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  trees$Height and trees$Volume</span></span>
<span><span class="co">## t = 4.0205, df = 29, p-value = 0.0003784</span></span>
<span><span class="co">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.3095235 0.7859756</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##       cor </span></span>
<span><span class="co">## 0.5982497</span></span></code></pre></div>

<p>Two non-parametric equivalents to Pearson correlation are available within the <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> function; Spearman’s rank and Kendall’s tau coefficient. To use either of these simply include the argument <code>method = "spearman"</code> or <code>method = "kendall"</code> depending on the test you wish to use. For example</p>

<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">trees</span><span class="op">$</span><span class="va">Height</span>, <span class="va">trees</span><span class="op">$</span><span class="va">Volume</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Spearman's rank correlation rho</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  trees$Height and trees$Volume</span></span>
<span><span class="co">## S = 2089.6, p-value = 0.0006484</span></span>
<span><span class="co">## alternative hypothesis: true rho is not equal to 0</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">##       rho </span></span>
<span><span class="co">## 0.5787101</span></span></code></pre></div>

</div>
<div id="simple_lm" class="section level2">
<h2>
<span class="header-section-number">7.3</span> Simple linear modelling<a class="anchor" aria-label="anchor" href="#simple_lm"><i class="fas fa-link"></i></a>
</h2>
<p>Linear models are one of the most widely used models in statistics and data science. They are often thought of as simple models but they’re very flexible and able to model a wide variety of experimental and survey designs. Many of the statistical approaches you may have used previously (such as linear regression, <em>t</em>-test, ANOVA, ANCOVA etc) can be expressed as a linear model so the good news is that you’re probably already familiar with linear models (albeit indirectly). They also form the foundation of more complicated modelling approaches and are relatively easy to extended to incorporate additional complexity. During this section we’ll learn how to fit some simple linear models using R and cover some of the more common applications. We won’t go into any detail of the underlying linear modelling theory but rather focus on the practicalities of model fitting and R code.</p>
<p>The main function for fitting linear models in R is the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function (short for linear model!). The <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function has many arguments but the most important is the first argument which specifies the model you want to fit using a <em>model formula</em> which typically takes the general form:</p>
<p> </p>
<blockquote>
<p><em>response variable ~ explanatory variable(s)</em></p>
</blockquote>
<p> </p>
<p>This model formula is simply read as</p>
<p> </p>
<blockquote>
<p><em>‘variation in the response variable modelled as a function (~) of the explanatory variable(s)’.</em></p>
</blockquote>
<p> </p>
<p>The response variable is also commonly known as the ‘dependent variable’ and the explanatory variables are sometimes referred to as ‘independent variables’ (or less frequently as ‘predictor variables’). There is also an additional term in our model formula which represents the variation in our response variable <strong>not</strong> explained by our explanatory variables but you don’t need to specify this when using the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function.</p>
<p>As mentioned above, many of the statistical ‘tests’ you might have previously used can be expressed as a linear model. For example, if we wanted to perform a bivariate linear regression between a response variable (<code>y</code>) and a single continuous explanatory variable (<code>x</code>) our model formula would simply be</p>
<p>y ~ x</p>
<p>On the other hand, if we wanted to use an ANOVA to test whether the group means of a response variable (<code>y</code>) were different between a three level factor (<code>x</code>) our model formula would look like</p>
<p>y ~ x</p>
<p>OK, hang on, they both look identical, what gives? In addition to the model formula, the type of linear model you fit is also determined by the type of data in your explanatory variable(s) (i.e. what class of data). If your explanatory variable is continuous then you will fit a bivariate linear regression. If your explanatory variable is a factor (i.e. categorical data) you will fit an ANOVA type model.</p>
<p>You can also increase the complexity of your linear model by including additional explanatory variables in your model formula. For example, if we wanted to fit a two-way ANOVA both of our explanatory variables <code>x</code> and <code>z</code> would need to be factors and separated by a <code>+</code> symbol</p>
<p>y ~ x + z</p>
<p>If we wanted to perform a factorial ANOVA to identify an interaction between both explanatory variables we would separate our explanatory variables with a <code>:</code> symbol whilst also including our main effects in our model formula</p>
<p>y ~ x + z + x:z</p>
<p>or by using the equivalent shortcut notation</p>
<p>y ~ x * z</p>
<p>It’s important that you get comfortable with using model formula (and we’ve only given the briefest of explanations above) when using the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function (and other functions) as it’s remarkably easy to specifiy a model which is either nonsense or isn’t the model you really wanted to fit. A summary table of various linear model formula and equivalent R code given below.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="26%">
<col width="31%">
<col width="42%">
</colgroup>
<thead><tr class="header">
<th align="left">Traditional name</th>
<th align="left">Model formula</th>
<th align="left">R code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Bivariate regression</td>
<td align="left">Y ~ X1 (continuous)</td>
<td align="left"><code>lm(Y ~ X)</code></td>
</tr>
<tr class="even">
<td align="left">One-way ANOVA</td>
<td align="left">Y ~ X1 (categorical)</td>
<td align="left"><code>lm(Y ~ X)</code></td>
</tr>
<tr class="odd">
<td align="left">Two-way ANOVA</td>
<td align="left">Y ~ X1 (cat) + X2(cat)</td>
<td align="left"><code>lm(Y ~ X1 + X2)</code></td>
</tr>
<tr class="even">
<td align="left">ANCOVA</td>
<td align="left">Y ~ X1 (cat) + X2(cont)</td>
<td align="left"><code>lm(Y ~ X1 + X2)</code></td>
</tr>
<tr class="odd">
<td align="left">Multiple regression</td>
<td align="left">Y ~ X1 (cont) + X2(cont)</td>
<td align="left"><code>lm(Y ~ X1 + X2)</code></td>
</tr>
<tr class="even">
<td align="left">Factorial ANOVA</td>
<td align="left">Y ~ X1 (cat) * X2(cat)</td>
<td align="left">
<p><code>lm(Y ~ X1 * X2)</code> or</p>
<p><code>lm(Y ~ X1 + X2 + X1:X2)</code></p>
</td>
</tr>
</tbody>
</table></div>
<p>OK, time for an example. The data file <code>smoking.txt</code> summarises the results of a study investigating the possible relationship between mortality rate and smoking across 25 occupational groups in the UK. The variable <code>occupational.group</code> specifies the different occupational groups studied, the <code>risk.group</code> variable indicates the relative risk to lung disease for the various occupational groups and <code>smoking</code> is an index of the average number of cigarettes smoked each day (relative to the number smoked across all occupations). The variable <code>mortality</code> is an index of the death rate from lung cancer in each group (relative to the death rate across all occupational groups). In this data set, the response variable is <code>mortality</code> and the potential explanatory variables are <code>smoking</code> which is numeric and <code>risk.group</code> which is a three level factor. The first thing to do is import our data file using the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function as usual and assign the data to an object called <code>smoke</code>. You can find a link to download these data, <a href="https://github.com/africanobyamugisha/datasets/tree/main/guide_to_R_programming%20data" title="click here to open the data folder">click here to open the data folder</a></p>

<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/smoking.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>    stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">smoke</span>, vec.len <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    25 obs. of  4 variables:</span></span>
<span><span class="co">##  $ occupational.group: Factor w/ 25 levels "Administrators",..: 9 14 2 11 10 ...</span></span>
<span><span class="co">##  $ risk.group        : Factor w/ 3 levels "high","low","medium": 2 1 1 3 1 ...</span></span>
<span><span class="co">##  $ smoking           : int  77 137 117 94 116 ...</span></span>
<span><span class="co">##  $ mortality         : int  84 116 123 128 155 ...</span></span>
<span><span class="co"># vec.len argument to limited number of ' first elements'</span></span>
<span><span class="co"># to display</span></span></code></pre></div>

<p>Next, let’s investigate the relationship between the <code>mortality</code> and <code>smoking</code> variables by plotting a scatter plot. We can use either the <code>ggplot2</code> package or base R graphics to do this. We’ll use <code>ggplot2</code> this time and our old friend the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> function.</p>

<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smoking</span>, y <span class="op">=</span> <span class="va">mortality</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss25-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>The plot does suggest that there is a positive relationship between the smoking index and mortality index.</p>
<p>To fit a simple linear model to these data we will use the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function and include our model formula <code>mortality ~ smoking</code> and assign the results to an object called <code>smoke_lm</code>.</p>

<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoke_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mortality</span> <span class="op">~</span> <span class="va">smoking</span>, data <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span></span></code></pre></div>

<p>Notice that we have not used the <code>$</code> notation to specify the variables in our model formula, instead we’ve used the <code>data = smoke</code> argument. Although the <code>$</code> notation will work (i.e. <code>smoke$mortality ~ smoke$smoking</code>) it will more than likely cause you problems later on and should be avoided. In fact, we would go as far to suggest that if any function has a <code>data =</code> argument you should <strong>always</strong> use it. How do you know if a function has a <code>data =</code> argument? Just look in the associated help file.</p>
<p>Perhaps somewhat confusingly (at least at first) it appears that nothing much has happened, you don’t automatically get the voluminous output that you normally get with other statistical packages. In fact, what R does, is store the output of the analysis in what is known as a <code>lm</code> class object (which we have called <code>smoke_lm</code>) from which you are able to extract exactly what you want using other functions. If you’re brave, you can examine the structure of the <code>smoke_lm</code> model object using the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function.</p>

<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span></span>
<span><span class="co">## List of 12</span></span>
<span><span class="co">##  $ coefficients : Named num [1:2] -2.89 1.09</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:2] "(Intercept)" "smoking"</span></span>
<span><span class="co">##  $ residuals    : Named num [1:25] 3.15 -30.11 -1.36 28.66 31.73 ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:25] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##  $ effects      : Named num [1:25] -545 -91.63 2.72 26.99 35.56 ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:25] "(Intercept)" "smoking" "" "" ...</span></span>
<span><span class="co">##  $ rank         : int 2</span></span>
<span><span class="co">##  $ fitted.values: Named num [1:25] 80.9 146.1 124.4 99.3 123.3 ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:25] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##  $ assign       : int [1:2] 0 1</span></span>
<span><span class="co">##  $ qr           :List of 5</span></span>
<span><span class="co">##   ..$ qr   : num [1:25, 1:2] -5 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:25] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:2] "(Intercept)" "smoking"</span></span>
<span><span class="co">##   .. ..- attr(*, "assign")= int [1:2] 0 1</span></span>
<span><span class="co">##   ..$ qraux: num [1:2] 1.2 1.46</span></span>
<span><span class="co">##   ..$ pivot: int [1:2] 1 2</span></span>
<span><span class="co">##   ..$ tol  : num 1e-07</span></span>
<span><span class="co">##   ..$ rank : int 2</span></span>
<span><span class="co">##   ..- attr(*, "class")= chr "qr"</span></span>
<span><span class="co">##  $ df.residual  : int 23</span></span>
<span><span class="co">##  $ xlevels      : Named list()</span></span>
<span><span class="co">##  $ call         : language lm(formula = mortality ~ smoking, data = smoke)</span></span>
<span><span class="co">##  $ terms        :Classes 'terms', 'formula'  language mortality ~ smoking</span></span>
<span><span class="co">##   .. ..- attr(*, "variables")= language list(mortality, smoking)</span></span>
<span><span class="co">##   .. ..- attr(*, "factors")= int [1:2, 1] 0 1</span></span>
<span><span class="co">##   .. .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. .. .. ..$ : chr [1:2] "mortality" "smoking"</span></span>
<span><span class="co">##   .. .. .. ..$ : chr "smoking"</span></span>
<span><span class="co">##   .. ..- attr(*, "term.labels")= chr "smoking"</span></span>
<span><span class="co">##   .. ..- attr(*, "order")= int 1</span></span>
<span><span class="co">##   .. ..- attr(*, "intercept")= int 1</span></span>
<span><span class="co">##   .. ..- attr(*, "response")= int 1</span></span>
<span><span class="co">##   .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; </span></span>
<span><span class="co">##   .. ..- attr(*, "predvars")= language list(mortality, smoking)</span></span>
<span><span class="co">##   .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"</span></span>
<span><span class="co">##   .. .. ..- attr(*, "names")= chr [1:2] "mortality" "smoking"</span></span>
<span><span class="co">##  $ model        :'data.frame':   25 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ mortality: int [1:25] 84 116 123 128 155 101 118 113 104 88 ...</span></span>
<span><span class="co">##   ..$ smoking  : int [1:25] 77 137 117 94 116 102 111 93 88 102 ...</span></span>
<span><span class="co">##   ..- attr(*, "terms")=Classes 'terms', 'formula'  language mortality ~ smoking</span></span>
<span><span class="co">##   .. .. ..- attr(*, "variables")= language list(mortality, smoking)</span></span>
<span><span class="co">##   .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1</span></span>
<span><span class="co">##   .. .. .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. .. .. .. ..$ : chr [1:2] "mortality" "smoking"</span></span>
<span><span class="co">##   .. .. .. .. ..$ : chr "smoking"</span></span>
<span><span class="co">##   .. .. ..- attr(*, "term.labels")= chr "smoking"</span></span>
<span><span class="co">##   .. .. ..- attr(*, "order")= int 1</span></span>
<span><span class="co">##   .. .. ..- attr(*, "intercept")= int 1</span></span>
<span><span class="co">##   .. .. ..- attr(*, "response")= int 1</span></span>
<span><span class="co">##   .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; </span></span>
<span><span class="co">##   .. .. ..- attr(*, "predvars")= language list(mortality, smoking)</span></span>
<span><span class="co">##   .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"</span></span>
<span><span class="co">##   .. .. .. ..- attr(*, "names")= chr [1:2] "mortality" "smoking"</span></span>
<span><span class="co">##  - attr(*, "class")= chr "lm"</span></span></code></pre></div>

<p>To obtain a summary of our analysis we can use the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function on our <code>smoke_lm</code> model object.</p>

<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = mortality ~ smoking, data = smoke)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -30.107 -17.892   3.145  14.132  31.732 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  -2.8853    23.0337  -0.125    0.901    </span></span>
<span><span class="co">## smoking       1.0875     0.2209   4.922 5.66e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  </span></span>
<span><span class="co">## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 18.62 on 23 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.513,  Adjusted R-squared:  0.4918 </span></span>
<span><span class="co">## F-statistic: 24.23 on 1 and 23 DF,  p-value: 5.658e-05</span></span></code></pre></div>

<p>This shows you everything you need to know about the parameter estimates (intercept and slope), their standard errors and associated <em>t</em> statistics and <em>p</em> values. The estimate for the Intercept suggests that when the relative smoking index is 0 the relative mortality rate is <code>-2.885</code>! The <em>p</em> value associated with the intercept tests the null hypothesis that the intercept is equal to zero. As the <em>p</em> value is large we fail to reject this null hypothesis. The <code>smoking</code> parameter estimate (<code>1.0875</code>) is the estimate of the slope and suggests that for every unit increase in the average number of cigarettes smoked each day the mortality risk index increases by 1.0875. The <em>p</em> value associated with the <code>smoking</code> parameter tests whether the slope of this relationship is equal to zero (i.e. no relationship). As our <em>p</em> value is small we reject this null hypothesis and therefore the slope is different from zero and therefore there is a significant relationship. The summary table also includes other important information such as the coefficient of determination (<em>R<sup>2</sup></em>), adjusted <em>R<sup>2</sup></em> , <em>F</em> statistic, associated degrees of freedom and <em>p</em> value. This information is a condensed form of an ANOVA table which you can see by using the <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function.</p>

<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: mortality</span></span>
<span><span class="co">##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## smoking    1 8395.7  8395.7  24.228 5.658e-05 ***</span></span>
<span><span class="co">## Residuals 23 7970.3   346.5                      </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  </span></span>
<span><span class="co">## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>

<p>Now let’s fit another linear model, but this time we will use the <code>risk.group</code> variable as our explanatory variable. Remember the <code>risk.group</code> variable is a factor and so our linear model will be equivalent to an ANOVA type analysis. We will be testing the null hypothesis that there is no difference in the mean mortality rate between the <code>low</code>, <code>medium</code> and <code>high</code> groups. We fit the model in exactly the same way as before.</p>

<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoke_risk_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mortality</span> <span class="op">~</span> <span class="va">risk.group</span>, data <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span></span></code></pre></div>

<p>Again, we can produce an ANOVA table using the <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function</p>

<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">smoke_risk_lm</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Variance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: mortality</span></span>
<span><span class="co">##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    </span></span>
<span><span class="co">## risk.group  2 11514.4  5757.2  26.107 1.554e-06 ***</span></span>
<span><span class="co">## Residuals  22  4851.6   220.5                      </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  </span></span>
<span><span class="co">## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>

<p>The results presented in the ANOVA table suggest that we can reject the null hypothesis (very small <em>p</em> value) and therefore the mean mortality rate index is different between <code>low</code>, <code>medium</code> and <code>high</code> risk groups.</p>
<p>As we did with our first linear model we can also produce a summary of the estimated parameters using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function.</p>

<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">smoke_risk_lm</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = mortality ~ risk.group, data = smoke)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -26.17 -11.45   4.00   9.00  26.83 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)        135.00       5.25  25.713  &lt; 2e-16 ***</span></span>
<span><span class="co">## risk.grouplow      -57.83       8.02  -7.211 3.16e-07 ***</span></span>
<span><span class="co">## risk.groupmedium   -27.55       6.90  -3.992 0.000615 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  </span></span>
<span><span class="co">## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 14.85 on 22 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7036, Adjusted R-squared:  0.6766 </span></span>
<span><span class="co">## F-statistic: 26.11 on 2 and 22 DF,  p-value: 1.554e-06</span></span></code></pre></div>

<p>In the summary table the Intercept is set to the first level of <code>risk.group</code> (<code>high</code>) as this occurs first alphabetically. Therefore, the estimated mean mortality index for <code>high</code> risk individuals is <code>135</code>. The estimates for <code>risk.grouplow</code> and <code>risk.groupmedium</code> are mean differences from the intercept (<code>high</code> group). So the mortality index for the <code>low</code> group is <code>135 - 57.83 = 77.17</code> and for the <code>medium</code> group is <code>135 - 27.55 = 107.45</code>. The <em>t</em> values and <em>p</em> values in the summary table are associated with testing specific hypotheses. The <em>p</em> value associated with the intercept tests the null hypothesis that the mean mortality index for the <code>high</code> group is equal to zero. To be honest this is not a particularly meaningful hypothesis to test but we can reject it anyway as we have a very small <em>p</em> value. The <em>p</em> value for the <code>risk.grouplow</code> parameter tests the null hypothesis that the mean difference between <code>high</code> and <code>low</code> risk groups is equal to zero (i.e. there is no difference). Again we reject this null hypothesis and conclude that the means are different between these two groups. Similarly, the <em>p</em> value for <code>risk.groupmedium</code> tests the null hypothesis that the mean difference between <code>high</code> and <code>medium</code> groups is equal to zero which we also reject.</p>
<p>Don’t worry too much if you find the output from the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function a little confusing. Its takes a bit of practice and experience to be able to make sense of all the numbers. Remember though, the more complicated your model is, the more complicated your interpretion will be. And always remember, a model that you can’t interpret is not worth fitting (most of the time!).</p>
<p>Another approach to interpreting your model output is to plot a graph of your data and then add the fitted model to this plot. Let’s go back to the first linear model we fitted (<code>smoke_lm</code>). We can add the fitted line to our previous plot using the <code>ggplot2</code> package and the <code>geom_smooth</code> geom. We can easily include the standard errors by specifying the <code>se = TRUE</code> argument.</p>

<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smoking</span>, y <span class="op">=</span> <span class="va">mortality</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss33-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>You can also do this with R’s base graphics. Note though that the fitted line extends beyond the data which is not great practice. If you want to prevent this you can generate predicted values from the model using the <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> function within the range of your data and then add these values to the plot using the <code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code> function (not shown).</p>

<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">$</span><span class="va">smoking</span>, <span class="va">smoke</span><span class="op">$</span><span class="va">mortality</span>, xlab <span class="op">=</span> <span class="st">"smoking rate"</span>, ylab <span class="op">=</span> <span class="st">" mortality rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span><span class="va">smoke_lm</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss34-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>Before we sit back and relax and admire our model (or go write that high impact paper your supervisor/boss has been harassing you about) our work is not finished. It’s vitally important to check the underlying assumptions of your linear model. Two of the most important assumption are equal variances (homogeneity of variance) and normality of residuals. To check for equal variances we can construct a graph of residuals versus fitted values. We can do this by first extracting the residuals and fitted values from our model object using the <code><a href="https://rdrr.io/r/stats/residuals.html">resid()</a></code> and <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> functions.</p>

<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoke_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span></span>
<span><span class="va">smoke_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span></span></code></pre></div>

<p>And then plot them using <code>ggplot</code> or base R graphics.</p>

<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smoke_fit</span>, y <span class="op">=</span> <span class="va">smoke_res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss36-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>It takes a little practice to interpret these types of graph, but what you are looking for is no pattern or structure in your residuals. What you definitely don’t want to see is the scatter increasing around the zero line (red dashed line) as the fitted values get bigger (this has been described as looking like a trumpet, a wedge of cheese or even a slice of pizza) which would indicate unequal variances (heteroscedacity).</p>
<p>To check for normality of residuals we can use our old friend the Q-Q plot using the residuals stored in the <code>smoke_res</code> object we created earlier.</p>

<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">smoke_res</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html">stat_qq_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss37-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>Or the same plot with base graphics.</p>

<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">smoke_res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">smoke_res</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss38-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>Alternatively, you can get R to do most of the hard work by using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function on the model object <code>smoke_lm</code>. Before we do this we should tell R that we want to plot four graphs in the same plotting window in RStudio using the <code>par(mfrow = c(2,2))</code>. This command splits the plotting window into 2 rows and 2 columns.</p>

<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss39-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>The first two graphs (top left and top right) are the same residual versus fitted and Q-Q plots we produced before. The third graph (bottom left) is the same as the first but plotted on a different scale (the absolute value of the square root of the standardised residuals) and again you are looking for no pattern or structure in the data points. The fourth graph (bottom right) gives you an indication whether any of your observations are having a large influence (Cook’s distance) on your regression coefficient estimates. Levearge identifies observations which have unusually large values in their explanatory variables.</p>
<p>You can also produce these diagnostic plots using <code>ggplot</code> by installing the package <code>ggfortify</code> and using the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code> function.</p>

<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify">ggfortify</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">smoke_lm</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">2</span>, label.size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss40-1.png" width="80%" style="display: block; margin: auto;"></div>

<p>What you do about influential data points or data points with high leverage is up to you. If you would like to examine the effect of removing one of these points on the parameter estimates you can use the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function. Let’s remove data point 2 (miners, mortality = 116 and smoking = 137) and store the results in a new object called <code>smoke_lm2</code>. Note, we do this to demonstrate the use of the <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> function. You should think long and hard about removing any data point(s) and if you do you should <strong>always</strong> report this and justify your reasoning.</p>

<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smoke_lm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">smoke_lm</span>, subset <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">smoke_lm2</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = mortality ~ smoking, data = smoke, subset = -2)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -29.7425 -11.6920  -0.4745  13.6141  28.7587 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -20.0755    23.5798  -0.851    0.404    </span></span>
<span><span class="co">## smoking       1.2693     0.2297   5.526 1.49e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  </span></span>
<span><span class="co">## 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 17.62 on 22 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.5813, Adjusted R-squared:  0.5622 </span></span>
<span><span class="co">## F-statistic: 30.54 on 1 and 22 DF,  p-value: 1.488e-05</span></span></code></pre></div>

<p>There are numerous other functions which are useful for producing diagnostic plots. For example, <code><a href="https://rdrr.io/r/stats/influence.measures.html">rstandard()</a></code> and <code><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent()</a></code> returns the standardised and studentised residuals. The function <code><a href="https://rdrr.io/r/stats/influence.measures.html">dffits()</a></code> expresses how much an observation influences the associated fitted value and the function <code><a href="https://rdrr.io/r/stats/influence.measures.html">dfbetas()</a></code> gives the change in the estimated parameters if an observation is excluded, relative to its standard error (intercept is the solid line and slope is the dashed line in the example below). The solid bold line in the same graph represents the Cook’s distance. Examples of how to use these functions are given below.</p>

<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dffits</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">rstudent</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">dfbetas</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html">cooks.distance</a></span><span class="op">(</span><span class="va">smoke_lm</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="guide_to_R_pragramming_files/figure-html/ss42-1.png" width="80%" style="display: block; margin: auto;"></div>

</div>
<div id="other-modelling-approaches" class="section level2">
<h2>
<span class="header-section-number">7.4</span> Other modelling approaches<a class="anchor" aria-label="anchor" href="#other-modelling-approaches"><i class="fas fa-link"></i></a>
</h2>
<p>As with most things R related, a complete description of the variety and flexibility of different statistical analyses you can perform is beyond the scope of this introductory guide. Further information can be found in any of the excellent documents referred to in the Additional Resources at the end of this guide and the cheat sheets.</p>
<p>A table of some of the more common statistical functions is given below to get you started.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="13%">
<col width="86%">
</colgroup>
<thead><tr class="header">
<th align="left">R function</th>
<th align="left">Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code></td>
<td align="left">Fit a generalised linear model with a specific error structure specified using the <code>family =</code> argument (Poisson, binomial, gamma)</td>
</tr>
<tr class="even">
<td align="left"><code>gam()</code></td>
<td align="left">Fit a generalised additive model. The R package <code>mgcv</code> must be loaded</td>
</tr>
<tr class="odd">
<td align="left">
<code>lme()</code> &amp; <code>nlme()</code>
</td>
<td align="left">Fit linear and non-linear mixed effects models. The R package <code>nlme</code> must be loaded</td>
</tr>
<tr class="even">
<td align="left"><code>lmer()</code></td>
<td align="left">Fit linear and generalised linear and non-linear mixed effects models.</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">The package <code>lme4</code> must be <strong>installed</strong> and loaded</td>
</tr>
<tr class="even">
<td align="left"><code>gls()</code></td>
<td align="left">Fit generalised least squares models. The R package <code>nlme</code> must be loaded</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code></td>
<td align="left">Performs a Kruskal-Wallis rank sum test</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test()</a></code></td>
<td align="left">Performs a Friedman’s test</td>
</tr>
</tbody>
</table></div>
<p> </p>
</div>
<div id="task-6" class="section level2">
<h2>
<span class="header-section-number">7.5</span> Task 6<a class="anchor" aria-label="anchor" href="#task-6"><i class="fas fa-link"></i></a>
</h2>
<p>Congratulations, you’ve reached the end of this Chapter! Perhaps now’s a good time to practice some of what you’ve learned</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data-visualisation.html"><span class="header-section-number">6</span> Data Visualisation</a></div>
<div class="next"><a href="functions.html"><span class="header-section-number">8</span> Functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#statistics-in-r"><span class="header-section-number">7</span> Statistics in R</a></li>
<li><a class="nav-link" href="#one-and-two-sample-tests"><span class="header-section-number">7.1</span> One and two sample tests</a></li>
<li><a class="nav-link" href="#correlation"><span class="header-section-number">7.2</span> Correlation</a></li>
<li><a class="nav-link" href="#simple_lm"><span class="header-section-number">7.3</span> Simple linear modelling</a></li>
<li><a class="nav-link" href="#other-modelling-approaches"><span class="header-section-number">7.4</span> Other modelling approaches</a></li>
<li><a class="nav-link" href="#task-6"><span class="header-section-number">7.5</span> Task 6</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Comprehensive Guide to Use R</strong>" was written by Africano BYAMUGISHA. It was last built on 2023-01-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
